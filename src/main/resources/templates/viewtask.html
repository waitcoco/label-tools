<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf/layout" layout:decorator="fragments/layout">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>任务管理</title>
    <style>
        .doc{
            float: left;width:60%; height:500px;overflow-y:auto;
        }
        .editor{
            float: right;width:40%; height:500px;overflow-y:auto;
        }
        .group{
            background: #f5f9f8; border: #c4c4c7 solid 1px;  border-radius: 5px; padding:5px;
        }
        .addbtn{
            color: #67bf81;
            border: solid 1px #cbdcc3;
            width: 100px;
            padding: 5px;
            margin: 5px;
            text-align: center;
            cursor:pointer;
        }
        .addbtnbig{
            color: #67bf81;
            border: solid 1px #cbdcc3;
            width: 100px;
            padding: 5px;
            margin: 5px;
            font-size:18px;
            text-align: center;
            cursor:pointer;
        }
        .margintop8{
            margin-top: 8px;
        }
        .delbtn{
            color: #da7878;
            border: solid 1px  #efe0e0;
            width: 100px;
            padding: 5px;
            margin: 2px;
            text-align: center;
            cursor:pointer;
        }
        .subbtn{
            color: #e82424;
            border: solid 1px #dcc8c3;
            width: 100px;
            padding: 5px;
            margin: 5px;
            font-size:18px;
            text-align: center;
            cursor:pointer;
        }
    </style>
    <script type="application/javascript">
        $(document).ready(function(e) {
            var filename = "/"+"[[${task.filename}]]";
            $("#docdiv").load(filename);

            $("body").on("click", ".addpfamily",function(){
                var html = '<div class="margintop8"><div>' +
                    ' 姓名：<input  name="pfamilyname" />' +
                    '</div>' +
                    '<div>' +
                    '关系：<input name="pfamilyrelation" />' +
                    '</div><div class="delbtn">删除</div></div>';
                $(this).before(html);
            });

            $("body").on("click", ".addfamily",function(){
                var html = '<div class="margintop8"><div>' +
                    ' 姓名：<input  name="familyname" />' +
                    '</div>' +
                    '<div>' +
                    '关系：<input name="familyrelation" />' +
                    '</div><div class="delbtn">删除</div></div>';
                $(this).before(html);
            });

            $("body").on("click", ".addpcontact",function(){
                var html = ' <div class="margintop8"><div>类型：<select name="pcontacttype" id="pcontacttype">' +
                    '<option>手机号</option>' +
                    '<option>座机</option>' +
                    '<option>微信</option>' +
                    '</select>' +
                    '</div>' +
                    '<div>号码：<input id="pcontactno" name="pcontactno" />（手机号/微信号）</div>' +
                    '<div>名称：<input id="pcontactname" name="pcontactname" />（姓名/微信名）</div>' +
                    '<div class="delbtn">删除</div></div>';
                $(this).before(html);
            });

            $("body").on("click", ".addcontact",function(){
                var html = ' <div class="margintop8"><div>类型：<select name="contacttype" id="contacttype">' +
                    '<option>手机号</option>' +
                    '<option>座机</option>' +
                    '<option>微信</option>' +
                    '</select>' +
                    '</div>' +
                    '<div>号码：<input id="contactno" name="contactno" />（手机号/微信号）</div>' +
                    '<div>名称：<input id="contactname" name="contactname" />（姓名/微信名）</div>' +
                    '<div class="delbtn">删除</div></div>';
                $(this).before(html);
            });

            $("body").on("click", ".addprelation",function(){
                var html='<div class="margintop8"><div>' +
                    '姓名：<input id="prelationname" name="prelationname" />' +
                    '</div>' +
                    '<div>' +
                    '关系：<input id="prelation" name="prelation" />' +
                    '</div> <div class="delbtn">删除</div></div>';
                $(this).before(html);
            });

            $("body").on("click", ".addrelation",function(){
                var html='<div class="margintop8"><div>' +
                    '姓名：<input id="relationname" name="relationname" />' +
                    '</div>' +
                    '<div>' +
                    '关系：<input id="relation" name="relation" />' +
                    '</div> <div class="delbtn">删除</div></div>';
                $(this).before(html);
            });



            $("body").on("click", ".addpart",function(){
                var html = '<div class="margintop8"><div>姓名：<input id="recordname" name="recordname" /></div>' +
                    '<div>角色:<select name="type" id="type">' +
                    '<option>买方</option>' +
                    '<option>卖方</option>' +
                    '<option>中间商</option>' +
                    '<option>吸毒者</option>' +
                    '</select></div>'+
                    '<div class="delbtn">删除</div></div>';
                $(this).before(html);
            });

            $("body").on("click", "#addevent",function(){
                var html = '<div class="margintop8"> <div class="group"><div class="form-group">' +
                    '<label>类型：</label>' +
                    '<select name="type" id="type">' +
                    '<option>吸毒</option>' +
                    '<option>贩毒</option>' +
                    '<option>带货</option>' +
                    '<option>吸毒贩毒</option>' +
                    '</select>' +
                    '</div>' +
                    '<div class="form-group">' +
                    '<label>地点：</label>' +
                    '<input id="recordname" name="recordname" />' +
                    '</div>' +
                    '<div class="form-group">' +
                    '<label>时间：</label>' +
                    '<input id="recordname" name="recordname" />' +
                    '</div>' +
                    '<div class="form-group">' +
                    '<label>参与人：</label>' +
                    '<div>姓名：<input id="recordname" name="recordname" /></div>' +
                    '<div>角色:<select name="type" id="type">' +
                    '<option>买方</option>' +
                    '<option>卖方</option>' +
                    '<option>中间商</option>' +
                    '<option>吸毒者</option>' +
                    '</select></div>' +
                    '<div class="addbtn addpart">增加参与人</div>' +
                    '</div>' +
                    '<div class="form-group">' +
                    '<label>标签：</label>' +
                    '<input id="recordname" name="recordname" />' +
                    '</div></div><div class="delbtn">删除</div></div>';
                $(this).before(html);
            });


            
            $("body").on("click", ".delbtn", function() {
                $(this).parent().remove();
            });

            $('form').submit(function(){
                    var ch = true;
                    var msg = '';
                    var checkvalue='';
                    var pfname='';
                    var pfrelation='';
                    var pcno='';
                    var pcname='';
                    var pctype='';
                    $("[name=pfamilyname]").each(function(index,e) {
                        if ($(this).val()!="") {
                            if ($("[name=pfamilyrelation]")[index].val()==""){
                                msg = '家庭关系不能为空';
                                $("[name=pfamilyrelation]")[index].focus();
                                ch = false;
                                return false;
                            }else{
                                pfname+= $(this).val()+',';
                                pfrelation+= $("[name=pfamilyrelation]")[index].val()+',';
                            }
                        }
                    });
                    if(pfname!=''){
                        $("#pfname").val(pfname.substr(0,pfname.length-1));
                        $("#pfrelation").val(pfrelation.substr(0,pfname.length-1));
                    }

                    $("[name=pcontactno]").each(function(index,e) {
                        if ($(this).val()!="") {
                            if ($("[name=pcontactname]")[index].val()==""){
                                msg = '联系方式名称不能为空';
                                $("[name=pcontactname]")[index].focus();
                                ch = false;
                                return false;
                            }else{
                                pcno+= $(this).val()+',';
                                pcname+= $("[name=pcontactname]")[index].val()+',';
                                pctype+= $("[name=pcontacttype]")[index].val()+',';
                            }
                        }
                    });
                    if(pcno!=''){
                        $("#pcno").val(pcno.substr(0,pcno.length-1));
                        $("#pcname").val(pcname.substr(0,pfname.length-1));
                        $("#pctype").val(pctype.substr(0,pctype.length-1));
                    }

                    if(!ch) {
                        alert(msg);
                        return false;
                    }

                }
            );
        });

    </script>
</head>

<body>
<div layout:fragment="content">
            <div id="page-wrapper">
                <!-- /.row -->
                <div class="row">
                    <div class="col-lg-12">
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                做任务
                            </div>
                            <div class="panel-body">
                                <div class="row">
                                    <div class="form-group">
                                        <label>任务编号：</label>
                                        <span th:text="${task.taskno}"></span>
                                        <label>任务类型</label>
                                        <span th:switch="${taskbatch.type}">
                                            <span th:case="'1'">笔录</span>
                                            <span th:case="'2'">车辆识别</span>
                                        </span>
                                        <label>任务描述：</label>
                                        <span th:text="${taskbatch.descr}"></span>
                                    </div>
                                    <div class="doc" id="docdiv"></div>

                                    <div class="col-lg-6 editor" >
                                        <form name="frm" th:action="@{../admin/saverecord}" method="post">
                                        <input type="hidden" id="pfname" name="pfname">
                                        <input type="hidden" id="pfrelation" name="pfrelation">
                                        <input type="hidden" id="pcno" name="pcno">
                                        <input type="hidden" id="pcname" name="pcname">
                                        <input type="hidden" id="pctype" name="pctype">

                                        <input type="hidden" id="prname" name="prname">
                                        <input type="hidden" id="prrelation" name="prrelation">

                                        <input type="hidden" id="fname" name="pfname">
                                        <input type="hidden" id="frelation" name="pfrelation">
                                        <input type="hidden" id="cno" name="cno">
                                        <input type="hidden" id="cname" name="cname">
                                        <input type="hidden" id="ctype" name="ctype">

                                        <input type="hidden" id="" name="rname">
                                        <input type="hidden" id="rrelation" name="rrelation">

                                        <div th:text="${msg}" style="color: #ff201e;"></div>
                                        <div class="form-group" style="text-align: center;font-size: 24px; color: #8c8c8c;">
                                            <label>录入区</label>
                                        </div>
                                        <div>笔录基本信息</div>
                                        <div class="group">
                                            <div class="form-group">
                                                <label>笔录名称：</label>
                                                <input id="recordname" name="recordname" />
                                            </div>
                                            <div class="form-group">
                                            <label>开始时间：</label>
                                                <input id="starttime" name="starttime" />
                                            </div>
                                            <div class="form-group">
                                                <label>结束时间：</label>
                                                <input id="endtime" name="endtime" />
                                            </div>
                                            <div class="form-group">
                                                <label>类型：</label>
                                               <select name="recordtype" id="recordtype">
                                                   <option>吸毒</option>
                                                   <option>贩毒</option>
                                                   <option>带货</option>
                                                   <option>吸毒贩毒</option>
                                               </select>
                                            </div>
                                            <div class="form-group">
                                                <label>标签：</label>
                                                <input id="recordtag" name="recordtag" />
                                            </div>
                                        </div>
                                        <div style="margin-top: 10px;">被询问人信息</div>
                                        <div class="group">
                                            <div class="form-group">
                                                <label>姓名：</label>
                                                <input id="pname" name="pname" />
                                            </div>
                                            <div class="form-group">
                                                <label>别名：</label>
                                                <input id="palias" name="palias" />(外号)
                                            </div>
                                            <div class="form-group">
                                                <label>性别：</label>
                                                <select name="psex" id="psex">
                                                    <option>男</option>
                                                    <option>女</option>
                                                </select>
                                            </div>
                                            <div class="form-group">
                                                <label>联系方式：</label>
                                                <div>类型：<select name="pcontacttype" id="pcontacttype">
                                                    <option>手机号</option>
                                                    <option>座机</option>
                                                    <option>微信</option>
                                                </select>
                                                </div>
                                                <div>号码：<input id="pcontactno" name="pcontactno" />（手机号/微信号）</div>
                                                <div>名称：<input id="pcontactname" name="pcontactname" />（姓名/微信名）</div>
                                                <div class="addbtn addpcontact">增加联系方式</div>
                                            </div>
                                            <div class="form-group">
                                                <label>年龄：</label>
                                                <input id="page" name="page" />
                                            </div>

                                            <div class="form-group">
                                                <label>民族：</label>
                                                <input id="pnation" name="pnation" />
                                            </div>
                                            <div class="form-group">
                                                <label>籍贯：</label>
                                                <input id="porigin" name="porigin" />
                                            </div>
                                            <div class="form-group">
                                                <label>出生日期：</label>
                                                <input id="pbirthday" name="pbirthday" />
                                            </div>
                                            <div class="form-group">
                                                <label>身份证件：</label>
                                                <div>类型:
                                                <select name="pidentifytype" id="pidentifytype">
                                                    <option>身份证</option>
                                                    <option>护照</option>
                                                    <option>军官证</option>
                                                </select>
                                                </div>
                                                <div>
                                                号码：<input id="pidentifyno" name="pidentifyno" /></div>
                                            </div>
                                            <div class="form-group">
                                                <label>现住址：</label>
                                                <input id="pplace" name="pplace" />
                                            </div>
                                            <div class="form-group">
                                                <label>户籍地：</label>
                                                <input id="pdomicile" name="pdomicile" />
                                            </div>
                                            <div class="form-group">
                                                <label>文化程度：</label>
                                                <select name="peducation" id="peducation">
                                                    <option>文盲</option>
                                                    <option>小学</option>
                                                    <option>初中</option>
                                                    <option>高中</option>
                                                    <option>大专</option>
                                                    <option>大学本科</option>
                                                    <option>研究生</option>
                                                    <option>博士</option>
                                                </select>
                                            </div>
                                            <div class="form-group">
                                                <label>工作：</label>
                                                <input id="pwork" name="pwork" />
                                            </div>

                                            <div class="form-group">
                                                <label>家庭成员：</label>
                                                <div>
                                                    姓名：<input  name="pfamilyname" />
                                                </div>
                                                <div>
                                                    关系：<input name="pfamilyrelation" />
                                                </div>
                                                <div class="addbtn addpfamily">增加家庭成员</div>
                                            </div>
                                            <div class="form-group">
                                                <label>关联关系：</label>
                                                <div>
                                                    姓名：<input id="prelationname" name="prelationname" />
                                                </div>
                                                <div>
                                                    关系：<input id="prelation" name="prelation" />
                                                </div>
                                                <div class="addbtn addprelation">增加关联关系</div>
                                                <div class="form-group">
                                                    <label>标签：</label>
                                                    <input id="ptag" name="ptag" />
                                                </div>
                                            </div>
                                        </div>

                                        <div style="margin-top: 10px;">关联人员</div>
                                        <div class="group">
                                            <div class="form-group">
                                                <label>人员信息：</label>
                                                <div class="form-group">
                                                    <label>姓名：</label>
                                                    <input id="name" name="name" />
                                                </div>
                                                <div class="form-group">
                                                    <label>别名：</label>
                                                    <input id="alias" name="alias" />(外号)
                                                </div>
                                                <div class="form-group">
                                                    <label>性别：</label>
                                                    <select name="sex" id="sex">
                                                        <option>男</option>
                                                        <option>女</option>
                                                    </select>
                                                </div>
                                                <div class="form-group">
                                                    <label>联系方式：</label>
                                                    <div>类型：<select name="contacttype" id="contacttype">
                                                        <option>手机号</option>
                                                        <option>座机</option>
                                                        <option>微信</option>
                                                    </select>
                                                    </div>
                                                    <div>号码：<input id="contactno" name="contactno" />（手机号/微信号）</div>
                                                    <div>名称：<input id="contactname" name="contactname" />（姓名/微信名）</div>
                                                    <div class="addbtn addcontact" >增加联系方式</div>
                                                </div>
                                                <div class="form-group">
                                                    <label>年龄：</label>
                                                    <input id="age" name="age" />
                                                </div>
                                                <div class="form-group">
                                                    <label>出生日期：</label>
                                                    <input id="birthday" name="birthday" />
                                                </div>
                                                <div class="form-group">
                                                    <label>民族：</label>
                                                    <input id="nation" name="nation" />
                                                </div>
                                                <div class="form-group">
                                                    <label>籍贯：</label>
                                                    <input id="origin" name="origin" />
                                                </div>
                                                <div class="form-group">
                                                    <label>身份证件：</label>
                                                    <div>类型:
                                                        <select name="identifytype" id="identifytype">
                                                            <option>身份证</option>
                                                            <option>护照</option>
                                                            <option>军官证</option>
                                                        </select>
                                                    </div>
                                                    <div>
                                                        号码：<input id="identifyno" name="identifyno" /></div>
                                                </div>
                                                <div class="form-group">
                                                    <label>现住址：</label>
                                                    <input id="place" name="place" />
                                                </div>
                                                <div class="form-group">
                                                    <label>户籍地：</label>
                                                    <input id="domicile" name="domicile" />
                                                </div>
                                                <div class="form-group">
                                                    <label>文化程度：</label>
                                                    <select name="education" id="education">
                                                        <option>文盲</option>
                                                        <option>小学</option>
                                                        <option>初中</option>
                                                        <option>高中</option>
                                                        <option>大专</option>
                                                        <option>大学本科</option>
                                                        <option>研究生</option>
                                                        <option>博士</option>
                                                    </select>
                                                </div>
                                                <div class="form-group">
                                                    <label>工作：</label>
                                                    <input id="work" name="work" />
                                                </div>

                                                <div class="form-group">
                                                    <label>家庭成员：</label>
                                                    <div>
                                                        姓名：<input id="familyname" name="familyname" />
                                                    </div>
                                                    <div>
                                                        关系：<input id="familyrelation" name="familyrelation" />
                                                    </div>
                                                    <div class="addbtn addfamily" >增加家庭成员</div>
                                                </div>
                                                <div class="form-group">
                                                    <label>关联关系：</label>
                                                    <div>
                                                        姓名：<input id="recordname" name="recordname" />
                                                    </div>
                                                    <div>
                                                        关系：<input id="recordname" name="recordname" />
                                                    </div>
                                                    <div class="addbtn addprelation" >增加关联关系</div>
                                                </div>
                                                <div class="form-group">
                                                    <label>标签：</label>
                                                    <input id="ctag" name="ctag" />
                                                </div>
                                            </div>
                                        </div>
                                        <div class="addbtnbig" id="addperson">增加人员</div>

                                        <div style="margin-top: 10px;">关联事件</div>
                                        <div class="group">
                                            <div class="form-group">
                                                <label>类型：</label>
                                                <select name="type" id="type">
                                                    <option>吸毒</option>
                                                    <option>贩毒</option>
                                                    <option>带货</option>
                                                    <option>吸毒贩毒</option>
                                                </select>
                                            </div>
                                            <div class="form-group">
                                                <label>地点：</label>
                                                <input id="recordname" name="recordname" />
                                            </div>
                                            <div class="form-group">
                                                <label>时间：</label>
                                                <input id="recordname" name="recordname" />
                                            </div>
                                            <div class="form-group">
                                                <label>参与人：</label>
                                               <div>姓名：<input id="name" name="recordname" /></div>
                                                <div>角色:<select name="type" id="type">
                                                    <option>买方</option>
                                                    <option>卖方</option>
                                                    <option>中间商</option>
                                                    <option>吸毒者</option>
                                                </select></div>
                                                <div class="addbtn addpart">增加参与人</div>
                                            </div>
                                            <div class="form-group">
                                                <label>标签：</label>
                                                <input id="eventtag" name="eventtag" />
                                            </div>

                                        </div>
                                            <div class="addbtnbig" id="addevent">增加事件</div>

                                            <input class="subbtn" type="submit" value="保 存">
                                     </form>
                                    </div>

                                </div>
                                <!-- /.row (nested) -->
                            </div>
                            <!-- /.panel-body -->
                        </div>
                        <!-- /.panel -->
                    </div>
                    <!-- /.col-lg-12 -->
                </div>
                <!-- /.row -->
            </div>
        <!-- /#page-wrapper -->
</div>



</body>

</html>
